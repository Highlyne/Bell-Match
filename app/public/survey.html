<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Bayside High Friend Matchup</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>
<style>
        .jumbotron {
            background-color: rgb(60, 247, 70);
            text-align: center;
        }
        
        .submitButton {
            color: rgb(218, 24, 143);
           
        }
</style>
<body background="https://st2.depositphotos.com/3547923/10757/v/950/depositphotos_107572620-stock-illustration-seamless-vintage-pattern-retro-80s.jpg">
    <div class="container">
        </br>
        <div class="jumbotron">
            <h1>Bayside High Matchup</h1>
            <h3>Fill out the short survey below to meet your new friend.</h3>
            <hr>
        </div>
              <!-- User Name and Photo Panel -->
      <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title"><strong>Let's Go!</strong></h3>
            </div>
            <div class="panel-body">
              <h4>Your Full Name</h4>
              <div class="input-group">
                <input id = "formName" class="form-control" type="text" name="name" placeholder="John Smith">
                <span class="input-group-addon">(Required)</span>
              </div>  
              <br>
              <h4>Link to a Photo Image</h4>
              <div class="input-group">
                <input id = "formImage" class="form-control" type="text" name="name" placeholder="http://yourphotolink.com.jpg/">
                <span class="input-group-addon">(Required)</span>
              </div>
              <br>
              <h4>Make a Statement</h4>
              <div class="input-group">
                <input id = "formQuote" class="form-control" type="text" name="name" placeholder="Say Anything">
                <span class="input-group-addon">(Required)</span>
              </div>
            </div>
          </div>
        <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title"><strong>Survey</strong></h3>
                </div>
                <div class="panel-body">
                  <!-- Questions -->
                  <h4><strong>Question 1</strong></h4>
                  <h5>The Bayside Tigers are playing tonight.  How likely are you to place a bet on them winning?</h5>
                  <select data-placeholder="" class="chosen-select" id="Q1">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
          
                  <h4><strong>Question 2</strong></h4>
                  <h5>Is it okay to wear plaid with stripes?</h5>
                  <select data-placeholder="" class="chosen-select" id="Q2">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                  <h4><strong>Question 3</strong></h4>
                  <h5>Are you willing to relocate for work?</h5>
                  <select data-placeholder="" class="chosen-select" id="Q3">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                  <h4><strong>Question 4</strong></h4>
                  <h5>You see a pretty girl at the lockers. How likely are you to talk to her?</h5>
                  <select data-placeholder="" class="chosen-select" id="Q4">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                  <h4><strong>Question 5</strong></h4>
                  <h5>Your life after high school is all planned out.</h5>
                  <select data-placeholder="" class="chosen-select" id="Q5">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                  <h4><strong>Question 6</strong></h4>
                  <h5>You are like super excited for the next Fall Dance.</h5>
                  <select data-placeholder="" class="chosen-select" id="Q6">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                  <h4><strong>Question 7</strong></h4>
                  <h5>How likely are you to signup to study abroad program?</h5>
                  <select data-placeholder="" class="chosen-select" id="Q7">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
                 
                  <h4><strong>Question 8</strong></h4>
                  <h5>Having loyal friends is the most important thing in life.</h5>
                  <select data-placeholder="" class="chosen-select" id="Q8">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                  <h4><strong>Question 9</strong></h4>
                  <h5>You always see the glass as have empty.</h5>
                  <select data-placeholder="" class="chosen-select" id="Q9">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
    
                  <h4><strong>Question 10</strong></h4>
                  <h5>How likely are you to fight for freedom when help is needed?</h5>
                  <select data-placeholder="" class="chosen-select" id="Q10">
                    <option value=""></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                  </select>
        
                </div>
              </div>
        
        
              <!-- Submit Button -->
              <button id="submitButton" type="submit" class="btn btn-md btn-danger btn-block"><h4><span class="glyphicon glyphicon-ok"></span> Match Me!</h4></button> 
              <br>
              <br>
              <br>
        
              <!-- Footer -->
              <nav class="navbar navbar-inverse navbar-fixed-bottom">
                    <div class="container-fluid">
                        <div class="navbar-header">
                        <a class="navbar-brand">Bell Match</a>
                        </div>
                        <ul class="nav navbar-nav">
                        <li><a href="/">Home</a></li>
                        <li><a href="/api/friends">API List</a></li>
                        <li><a href="/survey">Restart</a></li>
                        <li><a href="http://savedbythebell.wikia.com/wiki/Saved_by_the_Bell_Wiki" target="_blank">Fan Page</a></li>
                        </ul>
                    </div>
                    </nav> 
        
        
              <!-- Match Modal -->
              <div id="resultsModal" class="modal fade" role="dialog">
                <div class="modal-dialog">
                  <div class="modal-content">
                 <!-- Modal Header -->
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal">&times;</button>
                      <h2 class="modal-title"><strong>Your New Friend @ Bayside High!</strong></h2>
                    </div>
        
                    <!-- Show match details -->
                    <div class="modal-body">
                      <h2 id="matchName"></h2>
                      <h2 id="matchQuote"></h2>
                      <img id="matchImg" src="" alt="Image Not Found" style="max-width: 350px;">
                    </div>
        
                    <!-- Modal Footer -->
                    <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        
        
            <!-- Link in jQuery -->
            <script src="https://code.jquery.com/jquery.js"></script>
        
            <!-- Latest compiled and minified JavaScript (USED FOR THE MODAL) -->
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        
            <script>
              // Global Variable 
              var allFieldsCompleted;

            // Event Listener for Submission
              $(document).ready(function() {
                $('#submitButton').on('click', function() {
                  
                  // Check if all the user fields are completed
                  checkIfComplete(function(){

                    // AJAX call 
                    if(allFieldsCompleted){
                      collectInputs();
                    }
                    else{
                      alert('Please complete all fields before submitting!');
                    }
                  }); 
                }); 
              }); 

              // Function to valid user input
              function checkIfComplete(callback){
                var questionsCompleted;
                $('.chosen-select').each(function(){
                  if ( $(this).val() == "" ){
                    questionsCompleted = false;
                  }
                })

                // After complete, then run below
                .promise().done(function(){
                  // Check if any questions are incomplete
                  if(questionsCompleted == false){
                    allFieldsCompleted = false;
                  }
                  // Determine if Name is entered
                  else if( $('#formName').val().trim() == "" ){
                    allFieldsCompleted = false;
                  }
                  // Determine if Link is entered
                  else if( $('#formImage').val().trim() == "" ){
                    allFieldsCompleted = false;
                  }
                   // Determine if Quote is entered
                   else if( $('#formQuote').val().trim() == "" ){
                    allFieldsCompleted = false;
                  }
                  // Otherwise, the all fields are completed
                  else{
                    allFieldsCompleted = true;
                  }
                  callback();       
                });
              }

              function collectInputs(){
                
                var newFriend = {
                  name: $('#formName').val().trim(),
                  photo: $('#formImage').val().trim(),
                  quote: $('#formQuote').val().trim(),
                  scores: []
                };
                // Loop through Questions to get scores
                var scoresArray = [];
                $('.chosen-select').each(function(){
                  scoresArray.push( parseInt( $(this).val() ) ); // Parse Input Value as integer
                })
                 
                .promise().done(function(){ 
                  // Push the array of scores to the new friend object
                  newFriend.scores = scoresArray;
                  // POST the newFriend to the friends.js file and get back the best match
                  var currentURL = window.location.origin;
                  $.post(currentURL + "/api/friends", newFriend, function(data){
                    // Add Best Match attributes to Modal
                    $('#matchName').text(data.name);
                    $('#matchQuote').text(data.quote);
                    $('#matchImg').attr('src', data.photo);
                    // Show the modal with the best match 
                    $("#resultsModal").modal('toggle');
                  });
                });
              }
            </script>
</body>